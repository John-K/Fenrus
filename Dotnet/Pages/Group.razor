@page "/settings/groups/{uidString}"
@page "/settings/system/groups/{uidString}"
@using Fenrus.Models
@inherits UserPage

<PageTitle>Fenrus - Group</PageTitle>

<FenrusPage Title="Group" Icon="fa-solid fa-puzzle-piece">
    <Buttons>
        <button class="btn" @onclick="() => AddItem()">Add Item</button>
        <button class="btn" @onclick="() => Save()">Save</button>
        <button class="btn" @onclick="() => Cancel()">Cancel</button>
    </Buttons>
    <Body>
        <InputText Label="Name" @bind-Value="@Model.Name" Help="The Name of the group" />
        <InputColor Label="Accent" Placeholder="Default Color" @bind-Value="@Model.AccentColor" Help="The accent color for the group"></InputColor>
        <InputSwitch Label="Show Group Title" @bind-Value="@Model.HideGroupTitle" Help="Whether or not to show the group title."></InputSwitch>
    
        <div class="preview-dashboard">
            <div class="db-group @(Model.HideGroupTitle ? "hide-labels" : string.Empty)" style="width: unset; min-width: unset; height: unset; min-height: unset;">
                @if(Model.HideGroupTitle == false)
                {
                    <div class="title"><span>@Model.Name</span></div>
                }

                <div class="items" style="width: 30rem; height: 22.5rem; position: relative;">
                    @foreach (var item in Model.Items)
                    {
                        string icon = item.Icon;
                        if (string.IsNullOrEmpty(icon))
                        {
                            if (item is AppItem app)
                                icon = $"/apps/{Uri.EscapeDataString(app.AppName)}/app.png";
                            else
                                icon = "/favicion.svg";
                        }
                        icon += "?version=" + Globals.Version;
                        <a class="@item.Size.ToString().ToLower().Replace("xl", "x-l") db-@item.Type[9..].ToLower() db-item db-basic" title="@item.Name">
                            <div class="inner">
                                <div class="icon">
                                    <img src="@icon">
                                </div>
                                <div class="content">
                                    <div class="title">@item.Name</div>
                                    <div class="status"></div>
                                </div>
                                <div class="arrow"></div>
                                <div class="actions">
                                    <span title="Move Up" class="edit" @click="move(item, true)">
                                        <span class="fa-solid fa-angle-up"></span>
                                    </span>
                                    <span title="Move Down" class="edit" @click="move(item, false)">
                                        <span class="fa-solid fa-angle-down"></span>
                                    </span>
                                    <span title="Edit" class="edit" @onclick="() => Edit(item)">
                                        <span class="fa-solid fa-pen-to-square"></span>
                                    </span>
                                    <span title="Copy" class="copy" @click="copy(item)">
                                        <span class="fa-solid fa-copy"></span>
                                    </span>
                                    <span title="Delete" class="delete" @onclick="() => Delete(item)">
                                        <span class="fa-solid fa-trash"></span>
                                    </span>
                                </div>
                            </div>
                        </a>
                    }
                </div>
            </div>
        </div>
    </Body>
</FenrusPage>